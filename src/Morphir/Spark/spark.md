# Spark

This document is an overview on spark concepts that are relevant to morphir and the successful conversion of morphir to spark.

## The de-facto way of defining spark jobs. 

Spark jobs are pieces of code to be executed by spark. For every spark job, a few things are required:
1. create a spark session.
2. load/create a DF.
3. apply spark transformation/action on the DF.
4. save DF for downstream consumption.

*Here's an example of a spark application that could run in production*:
```
package app.examples.spark

import org.apache.spark.sql.functions._
import org.apache.spark.sql.types._

object SparkTestApp {
	def main(args: Array[String])) = {
		// create and configure a spark session
		val spark = SparkSession
			.builder()
			.appName("SparkTestApp")
			.enableHiveSupport()
			.getOrCreate()
		
		// read/create a data frame
		val df = spark.read.json(args(0))
		
		//apply transformation on DF's
		val newDF = df.filter(col("age") > 20) // trasnformation
					  .groupBy(col("age").alias("frequency")) // 
					  .count() // action
		
		// save DF
		newDF.write.saveAsTable("survey_frequency")

		// close spark session
		spark.stop()
	}
}
```

For the most part, spark jobs will consist of massive data transformations.

> Transformations are the basic building blocks for Spark developers. They are the key tools for the developers because **we use transformations to express our business logic**.
> source : [Preshat Kumar Pandey](https://www.learningjournal.guru/courses/spark/spark-foundation-training/spark-dataframe-transformations/#:~:text=Transformations%20are%20the%20basic%20building%20blocks%20for%20Spark%20developers.%20They%20are%20the%20key%20tools%20for%20the%20developers%20because%20we%20use%20transformations%20to%20express%20our%20business%20logic.)

## From Morphir to Spark
 
In morphir, business logic is defined with pure functions which is great for mapping to a spark transformation on a DF. For any single spark job however, these spark transformations would (in reality) all be tied together at some point ending with an action.

### How can we achieve a  mapping of morphir to spark?
One approach to answering this would require us to view organization of data that spark operates on as a Huge Data source that is composed of data tables, rows, columns, and just data.
More precisely, it would be a nested structure similar to the image below. 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkUAAAJjCAYAAAACi2XqAAAAAXNSR0IArs4c6QAABap0RVh0bXhmaWxlACUzQ214ZmlsZSUyMGhvc3QlM0QlMjJhcHAuZGlhZ3JhbXMubmV0JTIyJTIwbW9kaWZpZWQlM0QlMjIyMDIyLTExLTI3VDExJTNBNTQlM0EzMy42NjZaJTIyJTIwYWdlbnQlM0QlMjI1LjAlMjAoV2luZG93cyUyME5UJTIwMTAuMCUzQiUyMFdpbjY0JTNCJTIweDY0KSUyMEFwcGxlV2ViS2l0JTJGNTM3LjM2JTIwKEtIVE1MJTJDJTIwbGlrZSUyMEdlY2tvKSUyMENocm9tZSUyRjEwNy4wLjAuMCUyMFNhZmFyaSUyRjUzNy4zNiUyMiUyMGV0YWclM0QlMjJjNFR5Ynp3Vm1UbkhTSWZXNlJubyUyMiUyMHZlcnNpb24lM0QlMjIyMC4yLjglMjIlMjB0eXBlJTNEJTIyZ29vZ2xlJTIyJTNFJTNDZGlhZ3JhbSUyMGlkJTNEJTIyWktZc3Z3dE8waFBZOExKeEVPazIlMjIlMjBuYW1lJTNEJTIyUGFnZS0xJTIyJTNFN1pqTGJxTXdGSWFmaG1XUnIlMkJBc3A2UXpIV2x1bWxTYXRRUG1vam80UTgwazdkT1BDU2FCbWtTcEtwb3U2blpCJTJGbk53elAlMkY1SENmeGNMVGFmcW40T3YlMkJ1RWlFOUJKS3RoJTJCY2VRcEFnNURYJTJGSUhsc2xaQ1NWc2lxSXJGSkIyRlJQQWtyQXF2V1JTSWVCb2xhS2FtTDlWQ01WVm1LV0E4MFhsVnFNMHhMbFJ5JTJCNjVwbndoRVdNWmV1JTJCcWRJZEc1VkNNQWhjQ3VLTExkdnphZ05ySGlYYklXSG5DZHEwNVB3alllalNpbmRYcTIya1pDTmVaMHY3WDJmajBUM0M2dEVxYyUyQjU0ZSUyRmk1JTJCeHBGViUyQnhBdjc0dGF5JTJGYnFMNjlncUc3VFQlMkZ1S3p0RTl2VjZzZk9ncXhTOWRxbWlVcUw3Wmp4Zk5tbEEzZGhjUCUyQjRacDhJdFJLNmVqUXBkcUxBM21GM0NPeG0yQno4cHFIVjhwN1ZRY2VBVzhiWmZ1cUREZWJDT3ZFQ1Y1Qmp5cHhyM3JpaTZpb1dqa1BHb0RJUnpZekF3OWVidk5CaXNlWnhFOTJZc2pCYXJsZG1CWE5vTHJrc3N0SmNTNUdhQjdsdUxDM01mdnRrWmEyYSUyRkFkemUxRm0zM1k1Y3dnTzBsMFRieFhKbDBKZTglMkZnJTJCMnkwZ1VsSlZKcGFJbE5leW1Uc3RwT3hVRCUyQkU1dldGell2U2pNUHZRVHV3WEYlMkJYbFdKRmpyTzUyVyUyRktkb0hwR0l1R0NwWEdUcVN0MUwzcVJJR1ppbVU3Q3lFNURodVZHM1dvanN4R0NaREtDYmd1eUJIJTJCYmR2ayUyQiUyQmFXMCUyQld0MFZlcWUzbzVScnJ2eEtxN2tKVmd4R09FS2dZJTJGQ2tlSU0lMkZDQUVsREdFS1pvUmlDWUNEZkZiSERhdjkyNnNKSTVZWjVENzJIaTlIMlFxNzl3JTJCOTFiZXRkaE85dnpUOWt4a1NmRFJOODdqZDJUelg1b2ZoTWNBbXVkJTJGcndCWkxPTFJnM3ZKS0tGZ0VsRGJycVg3RU05Nkl4eDBMVWlKUHhzSjl6QmpPbkt3MDZuT2RVZ3YxN0plNVNTWkRZMWt3WGxPc2dtTGhYM1V5c2ptT3RuVTNweFI5OEhKZ1hSeFBDTjBBZzVBbW83UndTRUFVZVFlVXVsdVRFS3RxMHZzSXpvb1JjejJ1SHBrRVF2OGtMcHc4VlN0ek8xa0gxOHlUNUo4OW9tYWhHZCUyQnl3eGZUdEM4UFB5SXRvdjFmb3JFTiUyRjhCJTNDJTJGZGlhZ3JhbSUzRSUzQyUyRm14ZmlsZSUzRey1r6EAACAASURBVHhe7d19sCVlfSfwh91UMWNlF8WlZlZeNUReBkYgJJQgrrCLJLBFkgIXHRGwkhhmSEDDy+DwshQi8urIxIEZo4kRGDQVjFIBoyGQciSioGLCEIgVEJQ4AdGQ3WWGLbNs9YFz7Xvuuafv00/30+ee+7n/yNz7/Pp5+tNPV33r132OOwQ/BAgQIECAAAECYQcGBAgQIECAAAECQSiyCQgQIECAAAEChYBOkX1AgAABAgQIEBCK7AECBAgQIECAwEsCs3WKXgREgAABAgQIEJhggRkZaNZQtGXrQxPs4NQIECBAgACBhSqwbOkBQxtDQtFC3RHOmwABAgQILFABoWiBXninTYAAAQIECEwXEIrsCAIECBAgQIBACEEosg0IECBAgAABAkKRPUCAAAECBAgQeElAp8hOIECAAAECBAgIRfYAAQIECBAgQECnyB4gQIAAAQIECEwJeHxmMxAgQIAAAQIEPD6zBwgQIECAAAECHp/ZAwQIECBAgAABj8/sAQIECBAgQIBAWcA7RfYDAQIECBAgQMA7RfYAAQIECBAgQOAlAZ0iO4EAAQIECBAg0HYo2n/JsgWP/PA/b1nwBgAIECBAgMB8EGi1UyQUhSAUzYfbwBoJECBAgEDLj8+W/MzS8M53vjN88YtfnGb9la98JRxxxBGV/h/4wAfC6173ut4x5uuPUDRfr5x1EyBAgMBCE2i1U9QPRRdffPFUCHr00UfDySefHNavX18ZjISihbYdnS8BAgQIEOhOIHsoKk71lltuCZs3bw5r164Nixcv7v37lFNO6Sm84Q1vCJ/5zGfCAw88MPW7m2++udctGjZun332maa3bdu28L73vS9s3Lix9/t+bfHf9957b3jTm97U+/1v//Zv9+Yvforx73rXu3oh7dlnnw2/8zu/Ey699NLe384666ze/+6www69+Yuffvfr2GOP7f3u1a9+deiHvW9/+9uh/Hudou42t5kJECBAgECMQCehqAgQRej46Ec/Gh555JFQdIT64aL47+Kn6C6VO0VFoJltXPmEi+M89thjvfoi4Fx44YXhgx/8YPjhD3841aE65JBDekFo1113Deeee+7IUFTuavUDVz9A9edatWpVLyj1O2LFOp966qle6Hr8Xx+LuR7GEiBAgAABAh0JdB6Kii7LbKFm1OOzcviZrb78+yJU3XTTTVPdqX7I+sQnPtELW6M6RevWrQtFR6oc5srrHgxs5XH//JOtHV1a0xIgQIAAAQIxAp2EonKIeMUrXjHtcVex+Msuu2xGp2jwsVh53OAJFyHnkksu6f26/1L34CO7fnC59tprR4aifkerCEGD4ac/b/mxXP93/ceA//bKn8RcD2MJECBAgACBjgQ6CUXlgPLZz352xvtF/cdf5U7RsPeQ+uNmsyu/H1Q8PptLp6gIS8V7REV3qPgph6JRnaLyscvr8U5RRzvbtAQIECBAIFIgeyga/PRZOew8//zzvXdziheeB98pGjWufM7lIBXzTlHxflExZzHPNddc03vZezAUFccrvzvUX1NR9xu/8RtT7xQVvy9CUvG/Hp9F7kjDCRAgQIBARwJZ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RZFgKcOFohQ9tQQIECBAoF0Boahd32lHF4oyYpuKAAECBAhECghFkWApw4WiFD21BAgQIECgXQGhqF1fnaKMvqYiQIAAAQIpAkJRil5krU5RJJjhBAgQIEAgo4BQlBFbKMqIbSoCBAgQIBApIBRFgqUMF4pS9NQSIECAAIF2BYSidn2nHV0oyohtKgIECBAgECkgFEWCpQwXilL01BIgQIAAgXYFhKJ2fXWKMvqaigABAgQIpAgIRSl6kbU6RZFghhMgQIAAgYwCQlFGbKEoI7apCBAgQIBApIBQFAmWMlwoStFTS4AAAQIE2hUQitr1nXZ0oSgjtqkIECBAgECkgFAUCZYyXChK0VNLgAABAgTaFRCK2vXVKcroayoCBAgQIJAiIBSl6EXWFp0iPwQIECBAgMD4CqxcscvYLm7Z0gOKte0wuMAZv3h5wItbtj40tidjYQQIECBAgACBugJCUV05dQQIECBAgMBECQhFE3U5nQwBAgQIECBQV0AoqiunjgABAgQIEJgoAaFooi6nkyFAgAABAgTqCghFdeXUESBAgAABAhMlIBRN1OV0MgQIECBAgEBdAaGorpw6AgQIECBAYKIEhKKJupxOhgABAgQIEKgrIBTVlVNHgAABAgQITJSAUDRRl9PJECBAgAABAnUFhKK6cuoIECBAgACBiRIQiibqcjoZAgQIECBAoK6AUFRXTh0BAgQIECAwUQJC0URdTidDgAABAgQI1BUQiurKqSNAgAABAgQmSkAomqjL6WQIECBAgACBugJCUV05dQQIECBAgMBECQhFE3U5nQwBAgQIECBQV0AoqiunjgABAgQIEJgoAaFooi6nkyFAgAABAgTqCghFdeXUESBAgAABAhMlIBRN1OV0MgQIECBAgEBdAaGorpw6AgQIECBAYKIEhKKJupxOhgABAgQIEKgrIBTVlVNHgAABAgQITJSAUDRRl9PJECBAgAABAnUFhKK6cuoIECBAgACBiRIQiibqcjoZAgQIECBAoK6AUFRXTh0BAgQIECAwUQJC0URdTidDgAABAgQI1BUQiurKqSNAgAABAgQmSkAomqhWujV4AAAB9UlEQVTL6WQIECBAgACBugJCUV05dQQIECBAgMBECQhFE3U5nQwBAgQIECBQV0AoqiunjgABAgQIEJgoAaFooi6nkyFAgAABAgTqCghFdeXUESBAgAABAhMlIBRN1OV0MgQIECBAgEBdAaGorpw6AgQIECBAYKIEhKKJupxOhgABAgQIEKgrIBTVlVNHgAABAgQITJSAUDRRl9PJECBAgAABAnUFhKK6cuoIECBAgACBiRIQiibqcjoZAgQIECBAoK6AUFRXTh0BAgQIECAwUQJC0URdTidDgAABAgQI1BUQiurKqSNAgAABAgQmSkAomqjL6WQIECBAgACBugJCUV05dQQIECBAgMBECQhFE3U5nQwBAgQIECBQV0AoqiunjgABAgQIEJgoAaFooi6nkyFAgAABAgTqCghFdeXUESBAgAABAhMlIBRN1OV0MgQIECBAgEBdAaGorpw6AgQIECBAYKIEhKKJupxOhgABAgQIEKgrIBTVlVNHgAABAgQITJSAUDRRl9PJECBAgAABAnUFokNR3YnUESBAgAABAgTmgcAOg2uc8Yt5cBKWSIAAAQIECBBoXEAoapzUAQkQIECAAIH5KCAUzcerZs0ECBAgQIBA4wJCUeOkDkiAAAECBAjMRwGhaD5eNWsmQIAAAQIEGhf4/+i3PBYHM0XiAAAAAElFTkSuQmCC" style="cursor:pointer;max-width:100%;" onclick="(function(img){if(img.wnd!=null&&!img.wnd.closed){img.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&&evt.source==img.wnd){img.wnd.postMessage(decodeURIComponent(img.getAttribute('src')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);img.wnd=window.open('https://viewer.diagrams.net/?client=1&page=0');}})(this);"/>

Let's try to represent this in with morphir types
```Elm
type alias DataSource
	= List DataTable

type alias DataTable
	= List Row

type alias Row
	= Col

type alias Col 
	= { colName1: ColType, ..., colNameN: ColType }

type alias ColType
	= Spark.AST.Data
```

Looking at this image, we can already see that the spark transformations will receive a `DataTable`  and produce a `DataTable`,  and spark [*column expressions*](https://medium.com/@achilleus/https-medium-com-achilleus-a-practical-introduction-to-sparks-column-3f5fe83125c9) will receive a `Row` and return a `Row`. 

Something like this:
```Elm
type Ops
	= Transformation (DataTable -> DataTable)
	| ColumnExpression (Row -> Row)
```

With this, we can make the following assumptions about functions:
```Elm
-- Assume that transform is a transformation
transform: List { age: Int, name: String } -> List { age: Int }
transform table = 
	Debug.todo "Implementation details ignored"

-- Assume that selector is a column expression
selector: {age: Int, name: String} -> { age: Int }
selector row =
	Debug.todo "Implementation details ignored"
```



> Written with [StackEdit](https://stackedit.io/).
